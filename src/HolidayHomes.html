<!DOCTYPE html>
<html>
    <head>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

      <script src="https://www.gstatic.com/firebasejs/5.5.6/firebase.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.8.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.8.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.8.0/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.8.0/firebase-storage.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="css/homePage.css">
<link rel="stylesheet" type="text/css" href="css/topFive.css">
<link rel="stylesheet" type="text/css" href="css/footer.css">
<link rel="stylesheet" type="text/css" href="css/features.css">
<link rel="stylesheet" type="text/css" href="css/topthreeReviews.css">
<link rel="stylesheet" type="text/css" href="css/topfiveproperties.css">
<link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@600&display=swap" rel="stylesheet">
<link href= "https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css" rel="stylesheet"/>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<link href="https://fonts.googleapis.com/css2?family=Cairo&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Racing+Sans+One|Sirin+Stencil|Yatra+One&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/4.8.1/firebase.js"></script>
<script src="https://cdn.firebase.com/libs/firebaseui/2.5.1/firebaseui.js"></script>
<link rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/2.5.1/firebaseui.css" />
<link href="https://fonts.googleapis.com/css?family=Fredoka+One|Lalezar|Racing+Sans+One|Sirin+Stencil|Yatra+One&display=swap" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css">
<link rel="stylesheet" type="text/css" href="https://themify.me/wp-content/themes/themify-v32/themify-icons/themify-icons.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">

      <style>
        body{
          background-color: #f4f5f6;
        }
        p{
          color: #243245;
          font-size: 19px;

        }
        h2{
          color: #005451;
          font-family: 'Oswald', sans-serif;
         font-size: 35px;
         font-weight: bold;        }

.search{
          display: flex;
          width: 33%;
          margin: 1% auto;
        }

.MoreInfoButton{
display: inline-block;
  width: 90px;
  height: 40px;
  border-radius: 20px;
  background: #eaeaea;
  color: #300095;
  text-align: center;  
  font-size: 12px;
  font-weight: bold;
  margin-left: 5px;
  margin-top: 15px;
  border: 2px solid #fff;
  transition: all .2s ease;
  }

.SearchCities{
   padding: 20px;
   height: 100%;
   display: inline-block;
   max-height: 0 auto;
   background: #f4f5f6;
   width: 100%;
   /*box-shadow: 0 15px 20px -15px rgba(0, 0, 0, 0.3), 0 55px 50px -35px rgba(0, 0, 0, 0.3), 0 85px 60px -25px rgba(0, 0, 0, 0.1);*/
}

#cities{
  width: 300px;
  color: #300095;
  font-weight: bold;
}



 @keyframes pulse {
   0% {
     box-shadow: 0 0 0 0 var(--hover);
  }
}

 #raise:hover, #raise:focus {
   box-shadow: 0 0.5em 0.5em -0.4em var(--hover);
   transform: translateY(-0.25em);
}

#raise {
   --color: #300095;
   --hover: #300095;
}

 button {
   color: var(--color);
   transition: 0.25s;
       border-radius: 10px;
}
 button:hover, button:focus {
   border-color: var(--hover);
   color: #fff;
}
 
 button {
   background: transparent;
   border: 2px solid;
   font: inherit;
   line-height: 1;
   margin: 0.5em;
       border-radius: 10px;
   padding: 10px;
}

.ProInfo{
  border-radius: 65px;
  padding-left: 150px;
  padding-right: 150px;
  width: 100%;
  height: 400px;
  background-color: #eceef3;
  padding: 30px;
}
        .search{
          width: 33%;
          margin: 1% auto;
        }
     
        .pCity{
          font-size: 30px;
          margin-right: 5%;
          font-weight: bold;
        }
        .HImage{
          width: 350px;
          height: 340px;
          border-radius: 30px;
          float: left;
          margin-right: 30px;
          }          
    
        
        </style>

        <style type="text/css">
 
    body {
      background-color: transparent;
      transform: perspective(1400px) matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
      transform-style: preserve-3d;
    }
    
    .searchBox {
      position: absolute;
      top: 270px;
      left: 925px;
      width: 608px;
      height: 41px;
      font-size: 35px;

            }
    .searchBtn{
      position: absolute;
      left: 1550px;
      font-size: 30px;
      font-weight: bold;
      padding: 0px;
      width: 120px;
      height: 41px;
      top: 273px;
          border-radius: 10px;
    }
    #holidayTable{
      z-index: 40;
      position: absolute;
      top:30%;
      left:5%;
      font-size: 30px;
    }
    .btnSearch{
      font-size: 20px;
          margin:  auto;
          margin-left: 5%;
          font-weight: bold;
    }
    .header{
      display: flex;
      width: 100%;
    }
        </style>

    </head>



    <body>
             <header class="main-header">
       <div class="header">
       <img src="media/logo.png" class="webLogo">
    <nav class="main-nav">
         <ul>
            <li id="navPropertyOwner" style="display: none;"><a href="propertyOwnerDashboard.html"> Maneg Properties</a></li>
            <li><a href="HolidayHomes.html" style="color: grey; text-decoration: none;"> Holiday Homes</a></li>
            <li><a href="Login.html" style="color: grey; text-decoration: none;">Sign In</a></li>
            <li><a  href="MemberDashboard.html" style="color: grey; text-decoration: none;"> profile</a></li>
            <li><a  href="Memberregisteration.html" style="color: grey; text-decoration: none;"> register</a></li>
            <li><a id="signin" href="Login.html">Sign In</a></li>
            <li><a id="signout" href="#" onclick="logout()">Sign Out</a></li>
         </ul>
         </nav>
         </header>


       </br>
       </br>
       </br>
       </br>
       </br>
       </br>
       </br>
       </br>


    <div class="search">
      <P class="pCity" ></P>
       <select style="display: block;" id="cities">
          <option value="" style="display: block;" >City</option>
          <option value="idv4">Dammam</option>
          <option value="idv6">Jeddah</option>
          <option value="idv6">Makkah</option>
          <option value="idv6">Medina</option>
          <option value="idv6">Riyadh</option>

        </select>
        
      <button onclick="search()" class="btnSearch" id="raise"; >Search</button>


     </div>
    <div id="homsList">
   </div>
   </div>










<!--Footer-->

<footer class="new_footer_area bg_color">
            <div class="new_footer_top">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-3 col-md-6">
                            <div class="f_widget company_widget wow fadeInLeft" data-wow-delay="0.2s" style="visibility: visible; animation-delay: 0.2s; animation-name: fadeInLeft;">
                                <h3 class="f-title f_600 t_color f_size_18">Get in Touch</h3>
                                <p>Don’t miss any updates of our new templates and extensions.!</p>
                                <form action="#" class="f_subscribe_two mailchimp" method="post" novalidate="true" _lpchecked="1">
                                    <input type="text" name="EMAIL" class="form-control memail" placeholder="Email">
                                    <button class="btn btn_get btn_get_two" type="submit">Subscribe</button>
                                    <p class="mchimp-errmessage" style="display: none;"></p>
                                    <p class="mchimp-sucmessage" style="display: none;"></p>
                                </form>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-6">
                            <div class="f_widget about-widget pl_70 wow fadeInLeft" data-wow-delay="0.4s" style="visibility: visible; animation-delay: 0.4s; animation-name: fadeInLeft;">
                                <h3 class="f-title f_600 t_color f_size_18">Download</h3>
                                <ul class="list-unstyled f_list">
                                    <li><a href="#">Company</a></li>
                                    <li><a href="#">Android App</a></li>
                                    <li><a href="#">ios App</a></li>
                                    <li><a href="#">Desktop</a></li>
                                    <li><a href="#">Projects</a></li>
                                    <li><a href="#">My tasks</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-6">
                            <div class="f_widget about-widget pl_70 wow fadeInLeft" data-wow-delay="0.6s" style="visibility: visible; animation-delay: 0.6s; animation-name: fadeInLeft;">
                                <h3 class="f-title f_600 t_color f_size_18">Help</h3>
                                <ul class="list-unstyled f_list">
                                    <li><a href="#">FAQ</a></li>
                                    <li><a href="#">Term &amp; conditions</a></li>
                                    <li><a href="#">Reporting</a></li>
                                    <li><a href="#">Documentation</a></li>
                                    <li><a href="#">Support Policy</a></li>
                                    <li><a href="#">Privacy</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-6">
                            <div class="f_widget social-widget pl_70 wow fadeInLeft" data-wow-delay="0.8s" style="visibility: visible; animation-delay: 0.8s; animation-name: fadeInLeft;">
                                <h3 class="f-title f_600 t_color f_size_18">Team Solutions</h3>
                                <div class="f_social_icon">
                                    <a href="#" class="fab fa-facebook"></a>
                                    <a href="#" class="fab fa-twitter"></a>
                                    <a href="#" class="fab fa-linkedin"></a>
                                    <a href="#" class="fab fa-pinterest"></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="footer_bg">
                    <div class="footer_bg_one"></div>
                    <div class="footer_bg_two"></div>
                </div>
            </div>
            <div class="footer_bottom">
                <div class="container">
                    <div class="row align-items-center">
                        <div class="col-lg-6 col-sm-7">
                            <p class="mb-0 f_400">© cakecounter Inc.. 2019 All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
        </footer>

    </body> 



 <script>
   
   // Your web app's Firebase configuration
var firebaseConfig = {
 apiKey: "AIzaSyBVKHsqnVyaPbvPmgzPqEK_9p2Hm4ZucYc",
 authDomain: "trusted2020-8c803.firebaseapp.com",
 databaseURL: "https://trusted2020-8c803.firebaseio.com",
 projectId: "trusted2020-8c803",
 storageBucket: "trusted2020-8c803.appspot.com",
 messagingSenderId: "662663714362",
 appId: "1:662663714362:web:1842f051b9bddf5f48c703",
 measurementId: "G-QDZ39S220R"
};
// Initialize Firebase
firebase.initializeApp(firebaseConfig);

var uu = sessionStorage.getItem('userId22');
          
if(uu!=null)
{
   document.getElementById('signin').style.display='none';
   document.getElementById('signout').style.display='block';
}else
{
  
 document.getElementById('signin').style.display='block';
 document.getElementById('signout').style.display='none';
  
}

var url_string = window.location.href; //window.location.href
var url = new URL(url_string);
var city = url.searchParams.get("city");

if(city!=null)
{
  firebase.database().ref("Property").once('value').then(function (snapshot){
    snapshot.forEach(function (user){
      user.forEach(function (property){
        if(property.val().City===city)
        {
          firebase.database().ref("Reviews").orderByChild('PID').equalTo(property.key).once('value').then(function (reviewSnap){
            pid=property.key;
            pName=property.val().PropertyName;
            pDec=property.val().Description;
            pImg=property.val().Image;
            pReviewCount = reviewSnap.numChildren();

               pRate=0;
            i=0;
            reviewSnap.forEach(function (review){
              pRate+= parseInt(review.val().Rate);
              i++;
              if(pReviewCount===i)
              {
                pRate=pRate/pReviewCount;
            
            document.getElementById('homsList').innerHTML+=

         '<div class="SearchCities">'+
                              '<div class="ProInfo">'+
                '  <img class="HImage"  src="'+pImg+'"/>'+


                  '  <h2>'+pName+'</h3>'+
                  '  <p>'+pDec+'</p>'+

                      '   <span onClick="addReview(\''+pid+'\')" class="fa fa-clipboard matginAuto" style="margin-right: 10px;cursor: pointer;"> </span>'+
                      ' <label class="matginAuto" style="margin-left: 0;">'+pReviewCount+' Reviews</label>'+ '</br>' + 

                        '  <span class="fa fa-star matginAuto" style="margin-right: 10px; color:gold"></span>'+
                       '  <label class="matginAuto" style="margin-left: 0;">'+pRate+' Stars</label> '+ '</br>' + 

                        ' <button onClick="redirect(\''+pid+'\')" class="MoreInfoButton">More Info</button>'+
                 
                        ' </div>'+
                        ' </div>';


    
        }
            });
            
          
    
          });
        }
        
        
      });
    });
  });
}else
{
  
firebase.database().ref("Property").once('value').then(function (snapshot){
  snapshot.forEach(function (user){
    user.forEach(function (property){
      
      
      firebase.database().ref("Reviews").orderByChild('PID').equalTo(property.key).once('value').then(function (reviewSnap){
        pid=property.key;
        pName=property.val().PropertyName;
        pDec=property.val().Description;
        pImg=property.val().Image;
        pReviewCount = reviewSnap.numChildren();
         pRate=0;
        i=0;
        if(reviewSnap.val()===null)
        {
         
            document.getElementById('homsList').innerHTML+=

            '<div class="SearchCities">'+
                              '<div class="ProInfo">'+
                '  <img class="HImage"  src="'+pImg+'"/>'+


                  '  <h2>'+pName+'</h3>'+
                  '  <p>'+pDec+'</p>'+

                      '   <span onClick="addReview(\''+pid+'\')" class="fa fa-clipboard matginAuto" style="margin-right: 10px;cursor: pointer;"> </span>'+
                      ' <label class="matginAuto" style="margin-left: 0;">'+pReviewCount+' Reviews</label>'+ '</br>' + 

                        '  <span class="fa fa-star matginAuto" style="margin-right: 10px; color:gold"></span>'+
                       '  <label class="matginAuto" style="margin-left: 0;">'+pRate+' Stars</label> '+ '</br>' + 

                        ' <button onClick="redirect(\''+pid+'\')" class="MoreInfoButton">More Info</button>'+
                 
                        ' </div>'+
                        ' </div>';



       }
        reviewSnap.forEach(function (review){
          pRate+= parseInt(review.val().Rate);
          i++;
          if(pReviewCount===i)
          {
            pRate=Number((pRate/pReviewCount).toFixed(2));
  
            

            document.getElementById('homsList').innerHTML+=

             '<div class="SearchCities">'+
                              '<div class="ProInfo">'+
                '  <img class="HImage"  src="'+pImg+'"/>'+


                  '  <h2>'+pName+'</h3>'+
                  '  <p>'+pDec+'</p>'+

                      '   <span onClick="addReview(\''+pid+'\')" class="fa fa-clipboard matginAuto" style="margin-right: 10px;cursor: pointer;"> </span>'+
                      ' <label class="matginAuto" style="margin-left: 0;">'+pReviewCount+' Reviews</label>'+ '</br>' + 

                        '  <span class="fa fa-star matginAuto" style="margin-right: 10px; color:gold"></span>'+
                       '  <label class="matginAuto" style="margin-left: 0;">'+pRate+' Stars</label> '+ '</br>' + 

                        ' <button onClick="redirect(\''+pid+'\')" class="MoreInfoButton">More Info</button>'+
                 
                        ' </div>'+
                        ' </div>';


          }
        });
       

      });
    });
  });
});
}

function search()
{
  
  var e2 = document.getElementById("cities");
         city = e2.options[e2.selectedIndex].text;
  window.location.href="HolidayHomes.html?city="+city;

}

function redirect (propertyID)

{
  window.location.href="SingleHolidayHome.html?p="+propertyID;
}
function logout()
         {
          sessionStorage.removeItem('userId22');
          window.location.href = "HomePage2.html"
         }


</script>

 </body>

</html>